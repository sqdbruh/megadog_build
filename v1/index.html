<!DOCTYPE html>
<html lang="en-us">

<head>
  <style>
    html {
      height: 100%;
    }

    body {
      margin: 0;
      height: 100%;
      background: url(https://megamod-image.s3.amazonaws.com/bg.png);
      background-size: cover;
    }

    .shadow {
      box-shadow: 0 0 20px rgba(0, 0, 0, .2);
      border: 2px solid rgb(255, 255, 255);
      padding: 0px;
    }
	
	canvas.dots {
  position: absolute;
  box-shadow: 0 0 20px rgba(0, 0, 0, .2);
      border: 2px solid rgb(255, 255, 255);
      padding: 0px;
}
  </style>
  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="og:image" content="https://d2c9flql2ljv41.cloudfront.net/images/og_image.jpg"/>
  <title>MegaCode</title>
  <link rel="shortcut icon" href="TemplateData/favicon.ico">
  <link rel="stylesheet" href="TemplateData/style.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@900&display=swap" rel="stylesheet">
  <script src="https://login-sdk.xsolla.com/latest/"></script>
  <script type="text/javascript" src ="js/libraries/unpkg.com_js-cookie@3.0.5_dist_js.cookie.min.js"></script>
  <!-- <script src="https://cdn.jsdelivr.net/npm/js-cookie@3.0.5/dist/js.cookie.min.js"></script> -->
  <script type="text/javascript" src="js/cookies_manager.js"></script>
  <script type="text/javascript" src="js/unity.js"></script>
  <script type="text/javascript" src="js/helpers.js"></script>
  <script type="text/javascript" src="js/oauth_xsolla.js"></script>
  <script type="text/javascript" src="js/analytics_constants.js"></script>
  <script type="text/javascript" src="js/resizer.js"></script>
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/uuid/8.3.2/uuid.min.js"></script>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-SGFC31VKKL"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-SGFC31VKKL');
</script>

    <!-- MICROPHONE PRO START -->
    <script src='./microphone.js'></script>
    <!-- MICROPHONE PRO END -->
</head>
<body>
  <!--<script>-->

    <!--var isActive;-->
    <!--const hiddenNotifier = () => {-->
      <!--if (document.visibilityState == "hidden") {-->
	<!--isActive = setInterval(function() { -->
	  <!--if (myGameInstance != null)-->
	    <!--myGameInstance.SendMessage("GameManager", "DoSomething"); -->
	  <!--else-->
	    <!--console.log("myGameInstance is null");-->
	<!--}, 250);-->
      <!--} else {-->
	<!--clearInterval(isActive);-->
	<!--isActive = false;-->
      <!--}-->
    <!--}-->

    <!--document.addEventListener('visibilitychange', hiddenNotifier);-->

  <!--</script>-->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.0/FileSaver.js"></script>

  <div id="no-phone-container" style="width:100%; height:100%; display: none; justify-content: center;">
	<img src="https://megamod-image.s3.amazonaws.com/mobile_error.png" style="display: block; margin: auto;">
  </div>
  <!-- <div id="maintenance_break-container" style="width:100%; height:100%; display: none; justify-content: center;">
	<img src="TemplateData/maintenance_break/maintenance_break_bg.png" style="display: block; margin: auto;">
  </div> -->
  <div id="unity-container" class="unity-desktop">
	<div id="loader_canvas_div">
		 <img class="shadow" id="SPLASH_SCREEN" src="https://megamod-image.s3.amazonaws.com/SPLASH_SCREEN_JPG1.png" style="position: absolute;">
		<canvas class="dots" id ="loader_canvas" width=1280 height=720></canvas>
	</div>
	<div id="maintenance_break_div" style="display: none;">
		<img class="shadow" id="MAINTENANCE_BREAK" src="https://megamod-image.s3.amazonaws.com/PRODUCTION/maintenance_break_bg.png" style="position: absolute;">
		<div id="#maintenance_button_container">
		<button class="fade" id="maintenance_button" onclick="onMaintenanceBreakButtonClick()">Try again</button>
		</div>
		<!-- <canvas class="dots" id ="maintenance_break_canvas" width=1280 height=720></canvas> -->
   </div>
    <canvas class="shadow" id="unity-canvas" width=1280 height=720></canvas>
    <div id="unity-loading-bar">
      <div id="unity-progress-bar-empty">
        <div id="unity-progress-bar-full"></div>
      </div>
    </div>
    <div id="unity-warning"> </div>
  </div>
  <script type="text/javascript" src="js/app_version.js"></script>
  <script type="text/javascript" src="js/amplitude.js"></script>
  <script type="text/javascript" src="js/analytics.js"></script>
  <script type="text/javascript" src="js/redirects.js"></script>

  <script type="text/javascript" src="js/discord.js"></script>
  <script type="text/javascript" src="js/animated_loader.js"></script>
  <script type="text/javascript" src="js/maintenance_break.js"></script>
  <!--<script type="text/javascript" src="js/input_handler.js"></script>-->

  <script>

  </script>
  <script>
	var num = Math.floor(Math.random() * 2); // 0...6
  showLoader("https://megamod-image.s3.amazonaws.com/SPLASH_SCREEN_JPG"+(num+1)+".png");
  </script>
	<noscript><div><img src="https://mc.yandex.ru/watch/93348023" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
	<!-- /Yandex.Metrika counter -->
  <script>
  
  
    var container = document.querySelector("#unity-container");
	var mobile_error = document.querySelector("#no-phone-container");
	

		mobile_error.remove();

		
		
		var canvas = document.querySelector("#unity-canvas");
		var loader_canvas = document.querySelector("#loader_canvas");
		var SPLASH_SCREEN = document.querySelector("#SPLASH_SCREEN");
		var MAINTENANCE_BREAK = document.querySelector("#MAINTENANCE_BREAK");
		var warningBanner = document.querySelector("#unity-warning");
		var maintenance_button = document.querySelector("#maintenance_button");

		function unityShowBanner(msg, type) {
		function updateBannerVisibility() {
			warningBanner.style.display = warningBanner.children.length ? 'block' : 'none';
		}
		var div = document.createElement('div');
		div.innerHTML = msg;
		warningBanner.appendChild(div);
		if (type == 'error') div.style = 'background: red; padding: 10px;';
		else {
			if (type == 'warning') div.style = 'background: yellow; padding: 10px;';
			setTimeout(function () {
			warningBanner.removeChild(div);
			updateBannerVisibility();
			}, 5000);
		}
		updateBannerVisibility();
		}

			var buildUrl = "Build";
			var loaderUrl = buildUrl + "/betterspace-build.loader.js";
			var config = {
				dataUrl: buildUrl + "/betterspace-build.data.unityweb",
				frameworkUrl: buildUrl + "/betterspace-build.framework.js.unityweb",
				codeUrl: buildUrl + "/betterspace-build.wasm.unityweb",
				symbolsUrl: buildUrl + "/",
				streamingAssetsUrl: "StreamingAssets",
				companyName: "DefaultCompany",
				productName: "MegaMod",
				productVersion: "1.0.172",
				showBanner: unityShowBanner,
			};


		var myGameInstance = null;
		ResizerInit();
		
		startLoadUnity();
			

		function startLoadUnity(){
			destroyMaintenanceBreakUI();
			var script = document.createElement("script");
			script.src = loaderUrl;
			script.onload = () => {
			sendEvent(Unity_WebGL_Hello_world);
			createUnityInstance(canvas, config, (progress) => {

			}).then((unityInstance) => {
				window.unityInstance = unityInstance;
				myGameInstance = unityInstance;
				setTimeout(function () {
				closeLoader();
				sendEvent(Splash_Screen_Loading_Finished);
				}, 2500);
			}).catch((message) => {
				alert(message);
			});

			};
			document.body.appendChild(script);
		}

		function onMaintenanceBreakButtonClick(){
			console.log('onMaintenanceBreakButtonClick');
			var maintenance_button = document.querySelector("#maintenance_button");
			maintenance_button.disabled = true;
			sendEvent(Client_MaintenanceBreak_TryAgain_Click);

			checkMaintenanceBreak(function(result) 
			{
				if (result)
				{
					maintenance_button.disabled = false;
				}
				else
				{
					closeMaintenanceBreakUI();
					startLoadUnity();
				}
			});
		}
	
  </script>
</body>

</html>
